# Specification — S04: Flags-Cleanup

> **Parent project**: workflow-optimization-v32
> **Spec ID**: S04
> **Estimated effort**: 0.5 day
> **Category**: TINY
> **Priority**: LOW
> **Dependencies**: S01, S02
> **Blocks**: —

---

## 1. Context

This sub-spec is part of the **Workflow Optimization EPCI v3.2** project.

**Problem**:
- `--fast` flag is never used (risky, skips validations)
- `--dry-run` flag is never used (not implemented properly)
- No way to disable hooks explicitly

**Solution**: Remove unused flags, add `--no-hooks` flag.

**Source**: `brief-workflow-optimization-2025-12-23.md` — Section 5

---

## 2. Scope

### Included

- Remove `--fast` flag from all commands and documentation
- Remove `--dry-run` flag from all commands and documentation
- Add `--no-hooks` flag to disable hook execution
- Update flags.md documentation

### Excluded

- Changes to flag auto-activation logic
- New flag additions beyond `--no-hooks`
- Flag aliases or shortcuts

---

## 3. Tasks

### 3.1 Update flags.md

- [ ] Remove `--fast` from Workflow Flags section
- [ ] Remove `--dry-run` from Workflow Flags section
- [ ] Add `--no-hooks` to Workflow Flags section
- [ ] Update flag count (10 → 9 flags)

### 3.2 Update epci.md

- [ ] Remove `--fast` from argument-hint
- [ ] Remove `--dry-run` from argument-hint
- [ ] Add `--no-hooks` to argument-hint
- [ ] Remove `--fast` from Safety Flags table
- [ ] Remove `--dry-run` from Workflow Flags table
- [ ] Add `--no-hooks` description and behavior

### 3.3 Update epci-quick.md

- [ ] Remove `--fast` from argument-hint
- [ ] Remove `--fast` from Supported Flags table
- [ ] Add `--no-hooks` if applicable

### 3.4 Update CLAUDE.md

- [ ] Update section 3.7 "Système de Flags Universels"
- [ ] Update Catégories de Flags table
- [ ] Remove --fast/--dry-run from examples

### 3.5 Update hooks/runner.py

- [ ] Add check for `--no-hooks` flag in context
- [ ] Skip all hook execution if `--no-hooks` is set
- [ ] Log "Hooks disabled by --no-hooks flag" message

---

## 4. Acceptance Criteria

| ID | Criterion | Verification |
|----|-----------|--------------|
| S04-AC1 | --fast flag removed | Search codebase, verify no references |
| S04-AC2 | --dry-run flag removed | Search codebase, verify no references |
| S04-AC3 | --no-hooks disables all hooks | Run `/epci --no-hooks`, verify no hooks execute |
| S04-AC4 | Flag documentation updated | Check flags.md has 9 flags listed |

---

## 5. Impacted Files

| File | Action | Risk |
|------|--------|------|
| `src/settings/flags.md` | Modify | High |
| `src/commands/epci.md` | Modify | Medium |
| `src/commands/epci-quick.md` | Modify | Low |
| `src/hooks/runner.py` | Modify | Medium |
| `CLAUDE.md` | Modify | Low |

---

## 6. Source Reference

> Extract from `brief-workflow-optimization-2025-12-23.md`

### 5. Flags — Nettoyage

**Actions**:

| Action | Flag | Raison |
|--------|------|--------|
| **Supprimer** | `--fast` | Jamais utilisé, risqué |
| **Supprimer** | `--dry-run` | Jamais utilisé |
| **Ajouter** | `--no-hooks` | Désactiver tous les hooks |

**Inventaire final (9 flags)**:
```
Thinking:    --think, --think-hard, --ultrathink
Compression: --uc, --verbose
Workflow:    --safe, --no-hooks
Wave:        --wave, --wave-strategy
Legacy:      --large, --continue
```

---

## 7. Risks & Mitigations

| Risk | Probability | Mitigation |
|------|-------------|------------|
| Users relying on --fast | Low | Flag was never properly implemented |
| Users relying on --dry-run | Low | Flag was never properly implemented |
| --no-hooks misuse | Low | Document use cases (testing, CI/CD) |

---

*Generated by epci-decompose — Project: workflow-optimization-v32*
