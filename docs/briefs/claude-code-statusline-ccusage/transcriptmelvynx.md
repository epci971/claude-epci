Utilise cette Statusline ou SUPPRIME Claude Code (sérieux) - YouTube
https://www.youtube.com/watch?v=CgxOnY-RIlo

Transcript:
(00:00) Je pense que j&#39;ai créé la meilleure statut line que j&#39;ai jamais vu jusqu&#39;à maintenant. Je vais t&#39;expliquer exactement ce qu&#39;elle a. La première chose qu&#39;elle a, c&#39;est les informations sur Git avec les fichiers ajoutés, supprimés et les fichiers en staging. Ensuite, on a le dossier dans lequel on est actuellement. Ça, c&#39;est la base.
(00:17) Maintenant, on parle des choses très intéressantes. La deuxième lead va contenir la session avec le nombre de dollars qu&#39;on a utilisé dans la session actuelle. Ensuite, on va voir le nombre de tokens qui sont utilisés dans cette session avec le pourcentage qui est lié à cette utilisation.
(00:36)  Alors, quand on regarde à quel point c&#39;est accurate, on peut voir juste ici quand je fais slash context, j&#39;ai 81 % de token utilisés pour 163000 et ici ça m&#39;affiche bien 163000 et 81 % utilisé. Ça permet de savoir que quand tu arrives à 99 %, il va y avoir l&#39;autocompact qui s&#39;effectue automatiquement et c&#39;est une information cruciale quand tu codes pour réussir à avancer au fur et à mesure.
(01:00)  Et tout ça c&#39;est fait avec un custom script. Donc c&#39;est très cool. Tu vois que ici si je lance un nouveau chat, on va directement voir le contexte s&#39;afficher. Donc évidemment quand il y a pas de message ça marche pas. Mais dès qu&#39;on écrit un message ensuite il vient refresh ce contexte afin de nous donner les informations précises sur l&#39;utilisation de notre contexte.
(01:21)  Donc là, on voit 67000 tokens, 33 % et quand je fais slash contexte comme ceci, 67000 tokens 34 % j&#39;ai réussi à créer le script ultime pour avoir les informations précises du contexte. Et la dernière chose qu&#39;on va avoir ici, c&#39;est qui va contenir le pourcentage qu&#39;on a utilisé durant notre session.
(01:42)  Alors, à quoi ça enfin ça représente quoi ? Ça représente pardon pas la commande/c mais ça représente la commande/usage. Donc tu vois qu&#39;ici c&#39;est écrit 44 % et reset à 1 PM. Et donc là quand on regarde ici, on a exactement le même pourcentage. Donc il y a il y a quelques caches mais ici 43 % reset dans 2h et 6 minutes.
(02:04)  Et ça encore une fois c&#39;est essentiel pour comprendre à quel point tu es en train d&#39;utiliser ta session et combien d&#39;heures il te reste. Par exemple, moi je sais que quand j&#39;arrive à la fin de ma session et qu&#39;il me reste 30 minutes et ben je commence à bombarder les messages et quand il me reste encore beaucoup de sessions et ben je vais y aller un peu plus molo.
(02:20)  Donc ça c&#39;est ma statue line et pour la créer, j&#39;ai créé tout un projet parce que il y a eu énormément de réflexion. J&#39;ai passé de jours sur cette statue line à faire tout au pixel prêt. Et si tu as envie dès maintenant de pouvoir en profiter et de l&#39;utiliser, sache que j&#39;ai tout ajouté dans ça.
(02:39)  Setup cloud code en 10 secondes. Littéralement une commande dans le terminal pour tout setup. Tu vas pouvoir configurer Cloud code avec toutes mes commandes, tous mes agents et la configuration des permissions et ma statue line qui vont être ajoutés automatiquement dans ton setup, hein. Tu peux choisir ce que tu veux et tu peux choisir par exemple la statue line.
(02:57)  Alors, comment fonctionne cette statine ? He je vais te dévoiler tout simplement les secrets dans cette vidéo. Il y a pas besoin de de parler pendant 10000 ans. Cette statue line, elle est définie ici dans ce fichier index.ts qui me semble pas être ce fichier là finalement, mais plutôt index.ts juste ici et tu vois qu&#39;il y a vraiment une grosse grosse logique.
(03:15) C&#39;est pour ça que j&#39;ai carrément créé un projet entier entre guillemets statine ici pour faire tout ça. Donc on va y avoir on va avoir énormément de méthodes et différentes configurations qui vont être juste ici. Donc les guides branches et le dossier, ça c&#39;est pas très intéressant.
(03:30)  Ce qui nous intéresse c&#39;est le contexte data. Comment est-ce qu&#39;on fait pour récupérer le contexte avec Cloud Code juste ici ? Pour récupérer le contexte, on a une méthode ici dans contexte.mmd MD qui vient récupérer le transcript pass. Si tu le sais pas, en fait quand on récupère la statue line, on a un transcript paf qui vient nous donner l&#39;endroit précis du transcript.
(03:50) Et le transcript ça représente un fichier qui est ici. Donc là, tu vois qu&#39;ici, il y a plein de fichiers et tous ces fichiers c&#39;est le transcript complet de notre discussion. Grâce à ce transcript, on va pouvoir récupérer beaucoup d&#39;informations. C&#39;est-à-dire quand je viens ici dans get context data, on vient utiliser le transcript path pour récupérer le context lens.
(04:11) Donc ici avec un algorithme qui vient récupérer tous les messages pour récupérer combien de contextes on a utilisé de manière assez précise. Donc ici grâce à tout ça et euh au input token cash read input token and cash quation input token, on a en fait la majorité des informations qu&#39;on a besoin.
(04:30)  Et donc en fait c&#39;est ces ces informations ici elles sont dans ce fichier JSON. Une fois qu&#39;on a ça, j&#39;ai un petit paramètre pour savoir si on utilise les usable context only. Pourquoi est-ce qu&#39;il y a ce paramètre ? Parce qu&#39;en fait, si on fait slash contexte, on peut voir qu&#39;il y a 45000 tokens, 22,5 % qui sont utiliser ici pour l&#39;autocompact.
(04:49)  Qu&#39;est-ce que ça veut dire ? C&#39;est qu&#39;en fait quand il vient lancer la commande autocompact, il va te répondre à un énorme bloc de texte et pour générer du texte, il a besoin de la place. Et donc c&#39;est pour ça qu&#39;on a ici ce autocompact. Donc là, c&#39;est exactement ce qui est ici. Je viens utiliser cette valeur 45000 token qui est juste ici, qui va te permettre d&#39;être beaucoup plus accurate concernant le contexte qui est encore disponible.
(05:11) Ensuite, ici, j&#39;ai défini max contexte. Alors, d&#39;ailleurs ici, je pourrais tout de suite dire qu&#39;il peut déplacer tout ça dans la config. Et donc, bref, je récupère ce max contexte, je fend le par le je découvre le pourcentage et grâce à tout ça, je peux récupérer ces informations.
(05:27)  Donc, ça c&#39;est la première technique. Pour faire ça, comment j&#39;ai fait ? Évidemment, je l&#39;ai pas codé moi-même. Tu peux voir qu&#39;ici, j&#39;ai un énorme chat que j&#39;utilise depuis plusieurs jours. Donc, j&#39;ai ouvert plusieurs chats qui permettent de faire tout ça. Et j&#39;ai Reverse Enginer et des autres librairies alternatives pour que ce soit beaucoup plus précis.
(05:43)  Et d&#39;ailleurs, je me suis retrouvé avec des chiffres beaucoup plus précis que les librairies alternatives qui représentent précisément ce qu&#39;on a juste ici. Donc ça c&#39;est le premier truc. Celui-là c&#39;était pas le plus malin. Le plus malin, c&#39;est le get usage limit. Alors ça, malheureusement je suis pas sûr que ça a fonctionné si tu es sur Windows.
(06:00) Cependant, n&#39;hésite pas à demander à Lia de corriger ça. Peut-être que j&#39;inclurai des promes dans ce statut line pour venir trouver ceci. Qu&#39;est-ce qui se passe ici ? Bon, j&#39;ai rajouté un petit cach. Ça c&#39;est juste parce que juste ici, j&#39;ai rajouté un cache qui permet d&#39;éviter de spammer la PI d&#39;Open AI de pardon de de cloud.
(06:21)  Et donc ici dans ce get usage limit, je viens récupérer les credential. Pour récupérer les credential, j&#39;ai trouvé l&#39;endroit où cloud stock notre API token. Et donc ici, tu peux voir qu&#39;avec la commande security find generic password de cloud code créential, je viens trouver le credential.
(06:38)  Une fois que j&#39;ai ce crédal qui est juste ici, je viens ici fetch le usage limiter comment l&#39;autre code fonctionne quand on fait slash usage et ça fetch cet end point là api/ot/usage avec gets tous ces paramètres et notamment le token. Donc tu vois que là j&#39;ai rajouté tout pour simuler comme si j&#39;étais cl code et ensuite grâce à cette réponse et ben je peux avoir les limites dans les 5 hour et dans les 7 days qu&#39;on a juste ici que je récupère.
(07:07)  et que je retourne. Une fois que je les ai retourné eth ben c&#39;est très simple parce qu&#39;il nous suffit de faire format de tout ceci build seconde line et j&#39;ai tout ce qu&#39;il faut ici pour afficher la log avec toutes les différentes informations. Donc c&#39;est comme ça que j&#39;ai fait pour avoir toutes ces données super accurate.
(07:24)  Quand toi tu vas installer celui-ci, j&#39;ai rajouté des petites config et évidemment en fait tu peux rajouter une infinité de config parce que on va tout simplement pouvoir utiliser euh cloud pour venir modifier ce script. et ce projet très facilement parce que j&#39;ai évidemment documenté tout ça. Donc ici, tu vois qu&#39;on peut afficher ou non le modèle.
(07:44)  Donc là, quand je passe à tr, il faut tout le temps triger un petit changement juste ici. Et je vais cacher ma caméra parce que évidemment elle prend la place juste ici. Tu peux voir que là ça rajoute le nom du modèle mais par défaut, moi je me dis vu que sonnet c&#39;est le modèle par défaut, ça sert un peu à rien d&#39;afficher le modèle sonnet.
(07:59) Ensuite, on peut afficher le PAF avec différents modes juste ici que j&#39;ai mis là. Ensuite, on a git qui permet de chaud branche ou pas. On a separator ici qui est le caractère qui se met juste ici. On a tout ce qui est par rapport au contexte. Si par exemple demain Cloud code passe à 400000 de de contexte et ben j&#39;ai qu&#39;à update ça et ça met à jour automatiquement les données.
(08:22)  La même chose pour ça et cetera et cetera. Et là les limites, tu vois qu&#39;ici j&#39;ai une progress bar en fait qui a des couleurs ce que j&#39;appelle progressives. Donc plus tu arrives à la fin, plus je change de couleur. Mais on peut tout simplement mettre une autre couleur. Par exemple, si on a envie de mettre green comme ceci, on peut voir que je vais pas utiliser ce chat là parce que il y a déjà plein de contextes.
(08:43)  Je vais utiliser celui-ci. On peut voir que la couleur en fait va pouvoir changer juste ici. Donc suivant tes besoins, moi j&#39;aime bien progressive comme ça c&#39;est très minimaliste. où on peut tout simplement afficher le pourcentage avec si show progress bar false ou je peux aussi donc là si on fait on peut voir que ça va enlever la progress barre et là si j&#39;affiche la progress barre mais avec une barre de 5 tu vas voir que c&#39;est aussi assez pratique parce que ça va venir afficher la progress bar mais
(09:11) au lieu qu&#39;elle soit assez grande ça va la réduire à 5 et donc ça permet d&#39;avoir des caractères un peu plus petits comme tu peux le voir juste ici. Donc à toi de choisir ta configuration. En tout cas, tu peux tout installer. Si ça fonctionne pas sur Windows, quand tu essayes de l&#39;installer, moi je te dis hein, c&#39;est très simple de corriger le problème.
(09:28)  Tu lances Cloud Code, tu lui dis euh parce que moi je peux pas trop le faire parce que j&#39;ai pas de Windows, mais ici dans le projet, tu lui dis voilà le code qui est dans ici et on va dans tu commande qu&#39;est-ce que j&#39;ai ? J&#39;ai spend. Non, c&#39;est pas spend, c&#39;est usage limit. Le code qui est dans usage limit fonctionne pas car je suis sur Windows.
(09:53)  Trouve la clé API sur Windows STP et lui il va chercher. Là évidemment tu peux lui dire cherche sur internet et la clé API elle ressemble à AP je sais pas AP- qui comme ceci. Donc il faut juste retrouver le nom de la clé API. Moi, c&#39;est comme ça que je l&#39;avais retrouvé en Rivance Enginer et j&#39;avais trouvé ma clé API et ensuite je lui avais dit bah cherche cette clé à API sur mon Mac et il a cherché jusqu&#39;à trouver où était stocké cette clé à API.
(10:18)  Il y a pas 12000 endroits où c&#39;est possible de la stocker mais en tout cas ça fonctionne super bien. Donc je t&#39;invite à faire ceci comme ça tu vas avoir cette même statue line. Si tu as des améliorations hein, une fois que tu auras rejoint ce petit ce petit comité de personnes qui s&#39;amusent avec l&#39;autre code, tu pourras très facilement proposer des modifications pour cette statut line.
(10:38)  En tout cas, c&#39;est avec plaisir que je l&#39;offre gratuitement. suffit d&#39;aller dans le premier lien sous cette vidéo pour avoir accès à cette statine. Personnellement, je la surkiffe et je pense que je suis vraiment arrivé sur un un truc sympa. Peut-être qu&#39;il y a des informations un peu inutiles que j&#39;ai mis dans la config aussi pour enlever le le nombre de dollars sp parce que c&#39;est pas si important que ça.
(10:57)  C&#39;est plutôt un truc de branlette parce que tu es en mode wouh, il y a beaucoup de dollars qui sont utilisés, ça fait plaisir mais voilà. Dis-moi ce que tu en penses. On se retrouve bientôt. Ciao !
