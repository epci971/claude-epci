# Cahier des Charges â€” INT-01: GitHub Integration

> **Document**: CDC-INT01-001
> **Version**: 1.0.0
> **Date**: 2025-12-15
> **Statut**: ValidÃ©
> **Feature ID**: INT-01
> **Version cible**: EPCI v4.1
> **PrioritÃ©**: P1

---

## 1. Contexte Global EPCI

### 1.1 Philosophie EPCI v4.0

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        PHILOSOPHIE EPCI                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ğŸ¯ SIMPLICITÃ‰        â€” 5 commandes ciblÃ©es, pas 22                â”‚
â”‚  ğŸ“‹ TRAÃ‡ABILITÃ‰       â€” Feature Document pour chaque feature        â”‚
â”‚  â¸ï¸  BREAKPOINTS       â€” L'humain valide entre les phases           â”‚
â”‚  ğŸ”„ TDD               â€” Red â†’ Green â†’ Refactor systÃ©matique         â”‚
â”‚  ğŸ§© MODULARITÃ‰        â€” Skills, Agents, Commands sÃ©parÃ©s            â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Ã‰tat Actuel (Baseline v3.0.0)

EPCI v3.0.0 fonctionne en **isolation**. Les dÃ©veloppeurs doivent manuellement crÃ©er branches, commits et PRs.

### 1.3 Glossaire Pertinent

| Terme | DÃ©finition |
|-------|------------|
| **Branch** | Branche Git pour isoler le dÃ©veloppement |
| **PR** | Pull Request â€” demande de fusion de code |
| **Conventional Commits** | Standard de messages de commit |
| **Project Memory** | SystÃ¨me de persistance du contexte (F04) |

---

## 2. Description de la Feature

### 2.1 Contexte et Justification

**ProblÃ¨me** : Le workflow EPCI est dÃ©connectÃ© de GitHub :
- CrÃ©ation manuelle des branches
- Messages de commit gÃ©nÃ©riques
- PRs crÃ©Ã©es Ã  la main
- Pas de lien Feature â†” PR

**Solution** : IntÃ©gration GitHub automatisant :
- CrÃ©ation de branches avec pattern configurable
- Commits conventionnels auto-gÃ©nÃ©rÃ©s
- PRs avec template EPCI prÃ©-rempli
- Liens automatiques avec issues

### 2.2 Objectif

RÃ©duire les **actions manuelles de 70%** en automatisant le workflow Git/GitHub tout en maintenant la traÃ§abilitÃ© Feature â†’ Code â†’ PR.

---

## 3. FonctionnalitÃ©s

### 3.1 Branch Management

| Fonction | DÃ©clencheur | Action |
|----------|-------------|--------|
| **Auto-create branch** | DÃ©but Phase 2 | CrÃ©e `feature/{slug}` depuis base |
| **Branch naming** | Convention projet | Applique pattern configurÃ© |
| **Switch branch** | CrÃ©ation | Checkout automatique |

**Patterns supportÃ©s** :
- `feature/{slug}` (dÃ©faut)
- `{type}/{ticket}-{slug}` (avec issue)
- `{user}/{slug}` (par dÃ©veloppeur)

### 3.2 Commit Automation

| Fonction | DÃ©clencheur | Action |
|----------|-------------|--------|
| **Commit message** | Fin Phase 2 | GÃ©nÃ¨re message conventionnel |
| **Staged files** | Code gÃ©nÃ©rÃ© | Liste fichiers Ã  commiter |
| **Auto-commit** | Option user | Commit avec message gÃ©nÃ©rÃ© |

**Format commit Conventional Commits** :

```
feat(user): add preferences management endpoint

- Add UserPreferencesController with CRUD operations
- Add UserPreferences entity with validation
- Add unit and integration tests (12 tests)

Refs: #123
EPCI: user-preferences
```

### 3.3 Pull Request

| Fonction | DÃ©clencheur | Action |
|----------|-------------|--------|
| **Create PR** | Fin Phase 3 | Ouvre PR vers base branch |
| **PR template** | Config projet | Utilise template EPCI |
| **Auto-fill** | Feature Doc | Remplit description |
| **Labels** | ComplexitÃ© | size/S, type/feature |
| **Reviewers** | Config Ã©quipe | Assigne reviewers |

**Template PR EPCI** :

```markdown
## Summary

[Auto-rempli depuis Feature Document Â§1]

## Changes

- [Liste auto-gÃ©nÃ©rÃ©e des fichiers modifiÃ©s]

## Testing

- [x] Unit tests added (X tests)
- [x] Integration tests added (Y tests)
- [ ] Manual testing completed

## Checklist

- [x] Code follows project conventions
- [x] Documentation updated
- [x] No security vulnerabilities introduced

## Related

- Feature Document: `docs/features/{slug}.md`
- Issue: #{ticket}
- EPCI Workflow: {complexity}

---
Generated by EPCI v4.1
```

---

## 4. Workflow IntÃ©grÃ©

```
/epci-brief "Add user preferences #123"
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 1: Plan   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 2: Code   â”‚ â”€â”€â–º â”‚ ğŸ”€ git checkout -b feature/ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    user-preferences         â”‚
         â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 3: Final  â”‚ â”€â”€â–º â”‚ ğŸ“ git commit -m "feat:..." â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Completion    â”‚ â”€â”€â–º â”‚ ğŸ”ƒ Create PR + Link #123    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Configuration

### 5.1 Configuration Projet

```json
// project-memory/context.json
{
  "integrations": {
    "github": {
      "enabled": true,
      "repository": "owner/repo-name",
      "branch_pattern": "{type}/{ticket}-{slug}",
      "base_branch": "develop",
      "auto_create_branch": true,
      "auto_commit": true,
      "auto_pr": true,
      "reviewers": ["reviewer1", "reviewer2"],
      "labels": {
        "TINY": ["size/XS"],
        "SMALL": ["size/S"],
        "STANDARD": ["size/M"],
        "LARGE": ["size/L", "needs-review"]
      }
    }
  }
}
```

### 5.2 Commande `/epci-github`

```yaml
---
description: Manage GitHub integration for current feature
argument-hint: "[status|branch|commit|pr|sync]"
---

# Usage

/epci-github status    # Show integration status
/epci-github branch    # Create feature branch
/epci-github commit    # Stage and commit changes
/epci-github pr        # Create pull request
/epci-github sync      # Sync all (branch + commit + pr)
```

---

## 6. Exigences Techniques

### 6.1 Branch Management

| Exigence | Description | PrioritÃ© |
|----------|-------------|----------|
| [MUST] CrÃ©ation branche | `git checkout -b {pattern}` | P1 |
| [MUST] Pattern configurable | Variables: type, ticket, slug, user | P1 |
| [MUST] VÃ©rification existence | Ne pas Ã©craser branche existante | P1 |
| [SHOULD] Checkout auto | Switch vers nouvelle branche | P2 |

### 6.2 Commit Automation

| Exigence | Description | PrioritÃ© |
|----------|-------------|----------|
| [MUST] Conventional Commits | Format `type(scope): description` | P1 |
| [MUST] Liste fichiers | Afficher fichiers Ã  commiter | P1 |
| [MUST] Confirmation | Demander confirmation avant commit | P1 |
| [SHOULD] Scope auto | DÃ©duire scope du contexte | P2 |

### 6.3 Pull Request

| Exigence | Description | PrioritÃ© |
|----------|-------------|----------|
| [MUST] CrÃ©ation PR | Via `gh pr create` | P1 |
| [MUST] Template | Utiliser template EPCI | P1 |
| [MUST] Lien issue | Refs: #{ticket} | P1 |
| [SHOULD] Labels auto | Selon complexitÃ© | P2 |
| [SHOULD] Reviewers | Assigner automatiquement | P2 |

### 6.4 Mode DÃ©gradÃ©

| Exigence | Description | PrioritÃ© |
|----------|-------------|----------|
| [MUST] Sans GitHub | Workflow fonctionne sans intÃ©gration | P1 |
| [MUST] gh non installÃ© | Message explicatif, skip | P1 |
| [MUST] Auth Ã©chouÃ©e | Suggestion de `gh auth login` | P1 |

---

## 7. CritÃ¨res d'Acceptation

| ID | CritÃ¨re | MÃ©thode de vÃ©rification |
|----|---------|-------------------------|
| INT01-AC1 | Branche crÃ©Ã©e automatiquement | VÃ©rifier sur GitHub |
| INT01-AC2 | Commit message conventionnel | Regex validation |
| INT01-AC3 | PR crÃ©Ã©e avec template | VÃ©rifier sur GitHub |
| INT01-AC4 | Issue liÃ©e | Refs dans PR |
| INT01-AC5 | Mode dÃ©gradÃ© | Test sans GitHub config |

---

## 8. DÃ©pendances

### 8.1 DÃ©pendances Entrantes (cette feature dÃ©pend de)

| Feature | Type | Description |
|---------|------|-------------|
| F04 Project Memory | Forte | Stockage configuration GitHub |

### 8.2 DÃ©pendances Sortantes (dÃ©pendent de cette feature)

| Feature | Type | Description |
|---------|------|-------------|
| Aucune | â€” | Feature terminale |

### 8.3 DÃ©pendances Externes

| DÃ©pendance | Type | Description |
|------------|------|-------------|
| GitHub CLI (`gh`) | Optionnelle | Pour crÃ©ation PR |
| Git | Requise | Pour branches et commits |

---

## 9. Effort EstimÃ©

| TÃ¢che | Effort |
|-------|--------|
| Branch management | 6h |
| Commit automation | 4h |
| PR creation | 6h |
| Issue linking | 2h |
| Commande /epci-github | 4h |
| Tests | 2h |
| **Total** | **24h (3j)** |

---

## 10. Livrables

1. Module de gestion des branches
2. Module de gÃ©nÃ©ration commits
3. Module de crÃ©ation PR
4. Commande `/epci-github`
5. Template PR EPCI
6. Documentation utilisateur
7. Tests unitaires et d'intÃ©gration

---

## 11. SÃ©curitÃ©

| PrÃ©occupation | Mesure |
|---------------|--------|
| **Tokens GitHub** | Jamais stockÃ©s dans project-memory, utiliser `gh auth` |
| **Permissions** | VÃ©rifier droits avant opÃ©rations |
| **Branches protÃ©gÃ©es** | Respecter rÃ¨gles de protection |
| **Secrets dans commits** | VÃ©rifier absence avant commit |

---

## 12. Exemples d'Usage

### 12.1 Workflow Complet

```bash
# Brief avec numÃ©ro d'issue
/epci-brief "Add user preferences API #42"

# Phase 1...
# Phase 2 â†’ Branche crÃ©Ã©e automatiquement
#   git checkout -b feature/42-user-preferences

# Phase 3 â†’ Commit gÃ©nÃ©rÃ©
#   git commit -m "feat(user): add preferences management API
#
#   - Add UserPreferencesController
#   - Add UserPreferences entity
#   - Add unit tests (8 tests)
#
#   Refs: #42
#   EPCI: user-preferences"

# Fin â†’ PR crÃ©Ã©e
#   gh pr create --title "feat(user): add preferences management API"
#                --body "[template rempli]"
#                --reviewer alice,bob
#                --label "size/M,type/feature"
```

### 12.2 Commande Manuelle

```bash
# CrÃ©er branche manuellement
/epci-github branch user-preferences

# CrÃ©er commit manuellement
/epci-github commit

# CrÃ©er PR manuellement
/epci-github pr

# Tout synchroniser
/epci-github sync
```

---

## 13. Hors PÃ©rimÃ¨tre

- IntÃ©gration GitLab / Bitbucket
- Merge automatique des PRs
- Gestion des conflits de merge
- CI/CD integration
- Code review automatisÃ©e

---

*Document gÃ©nÃ©rÃ© depuis CDC-EPCI-UNIFIE-v4.md*
