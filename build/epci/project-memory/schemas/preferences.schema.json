{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "epci-project-memory-preferences",
  "title": "EPCI Learning Preferences",
  "description": "Schema for user preferences stored in .project-memory/learning/preferences.json",
  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "suggestion_feedback": {
      "type": "object",
      "description": "Feedback statistics per suggestion pattern",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "accepted": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of times accepted"
          },
          "rejected": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of times rejected/ignored"
          },
          "acceptance_rate": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Calculated acceptance rate"
          },
          "last_seen": {
            "type": "string",
            "format": "date-time"
          },
          "last_action": {
            "type": "string",
            "enum": ["accepted", "rejected", "ignored"]
          }
        }
      }
    },
    "disabled_suggestions": {
      "type": "array",
      "description": "Patterns the user never wants to see",
      "items": {
        "type": "string"
      }
    },
    "preferred_patterns": {
      "type": "array",
      "description": "Patterns the user prefers (boosted priority)",
      "items": {
        "type": "string"
      }
    },
    "settings": {
      "type": "object",
      "description": "Learning behavior settings",
      "properties": {
        "learning_enabled": {
          "type": "boolean",
          "default": true,
          "description": "Whether learning is enabled"
        },
        "suggestion_threshold": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "default": 0.3,
          "description": "Minimum score to show a suggestion"
        },
        "max_suggestions_per_breakpoint": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10,
          "default": 5,
          "description": "Maximum suggestions to show at breakpoints"
        }
      }
    },
    "updated_at": {
      "type": "string",
      "format": "date-time"
    }
  },
  "required": ["version"]
}
